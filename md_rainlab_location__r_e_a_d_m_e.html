<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Jegyzetszerver: Location plugin</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Jegyzetszerver
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Location plugin </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This plugin adds location based features to <a href="http://octobercms.com">OctoberCMS</a>.</p>
<ul>
<li>Easily add Country and State to any model</li>
<li>Form widget for address lookups (Google API)</li>
</ul>
<h2><a class="anchor" id="autotoc_md453"></a>
Extended features</h2>
<p>To integrate locations with front-end users consider installing the <a href="http://octobercms.com/plugin/rainlab-userplus">User Plus+ plugin</a> (<code>RainLab.UserPlus</code>).</p>
<h2><a class="anchor" id="autotoc_md454"></a>
Google API key requirement</h2>
<p>As of June 22, 2016 the Google Maps service requires an API key. You may generate a key from the following link:</p>
<ul>
<li><a href="https://developers.google.com/maps/documentation/javascript/get-api-key">Get a Google API key</a></li>
</ul>
<p>Copy the key and enter it in the <b>Settings &gt; Location settings</b> area. If you find the address finder is not working, you may need to enable the <a href="https://console.developers.google.com/apis/api/places_backend/overview?project=_">Places API</a> and the <a href="https://console.developers.google.com/apis/api/maps_backend/overview?project=_">Maps JavaScript API</a>.</p>
<h2><a class="anchor" id="autotoc_md455"></a>
Add Country and State to any model</h2>
<p>This plugin provides an easy way to add location fields, country and state, to any model. Simply add these columns to the database table: </p><pre class="fragment">$table-&gt;integer('country_id')-&gt;unsigned()-&gt;nullable()-&gt;index();
$table-&gt;integer('state_id')-&gt;unsigned()-&gt;nullable()-&gt;index();
</pre><p> Then implement the <b><a class="el" href="class_rain_lab_1_1_location_1_1_behaviors_1_1_location_model.html">RainLab.Location.Behaviors.LocationModel</a></b> behavior in the model class: </p><pre class="fragment">public $implement = ['RainLab.Location.Behaviors.LocationModel'];
</pre><p> This will automatically create two "belongs to" relationships:</p>
<ol type="1">
<li><b>state</b> - relation for RainLab\Location\Models\State</li>
</ol>
<ol type="1">
<li><b>country</b> - relation for RainLab\Location\Models\Country</li>
</ol>
<h2><a class="anchor" id="autotoc_md456"></a>
Back-end usage</h2>
<h3><a class="anchor" id="autotoc_md457"></a>
Forms</h3>
<p>You are free to add the following form field definitions: </p><pre class="fragment">country:
    label: rainlab.location::lang.country.label
    type: dropdown
    span: left
    placeholder: rainlab.location::lang.country.select

state:
    label: rainlab.location::lang.state.label
    type: dropdown
    span: right
    dependsOn: country
    placeholder: rainlab.location::lang.state.select
</pre> <h3><a class="anchor" id="autotoc_md458"></a>
Lists</h3>
<p>For the list column definitions, you can use the following snippet: </p><pre class="fragment"> country:
     label: rainlab.location::lang.country.label
     searchable: true
     relation: country
     select: name
     sortable: false

 state:
     label: rainlab.location::lang.state.label
     searchable: true
     relation: state
     select: name
     sortable: false
</pre> <h2><a class="anchor" id="autotoc_md459"></a>
Front-end usage</h2>
<p>The front-end can also use the relationships by creating a partial called <b>country-state</b> with the content: </p><pre class="fragment">{% set countryId = countryId|default(form_value('country_id')) %}
{% set stateId = stateId|default(form_value('state_id')) %}

&lt;div class="form-group"&gt;
    &lt;label for="accountCountry"&gt;Country&lt;/label&gt;
    {{ form_select_country('country_id', countryId, {
        id: 'accountCountry',
        class: 'form-control',
        emptyOption: '',
        'data-request': 'onInit',
        'data-request-update': {
            'country-state': '#partialCountryState'
        }
    }) }}
&lt;/div&gt;

&lt;div class="form-group"&gt;
    &lt;label for="accountState"&gt;State&lt;/label&gt;
    {{ form_select_state('state_id', countryId, stateId, {
        id: 'accountState',
        class: 'form-control',
        emptyOption: ''
    }) }}
&lt;/div&gt;
</pre><p> This partial can be rendered in a form with the following: </p><pre class="fragment">&lt;div id="partialCountryState"&gt;
    {% partial 'country-state' countryId=user.country_id stateId=user.state_id %}
&lt;/div&gt;
</pre> <h2><a class="anchor" id="autotoc_md460"></a>
Short code accessors</h2>
<p>The behavior will also add a special short code accessor and setter to the model that converts <code>country_code</code> and <code>state_code</code> to their respective identifiers. </p><pre class="fragment">// Softly looks up and sets the country_id and state_id
// for these Country and State relations.

$model-&gt;country_code = "US";
$model-&gt;state_code = "FL";
$model-&gt;save();
</pre> <h2><a class="anchor" id="autotoc_md461"></a>
Address Finder Form Widget</h2>
<p>This plugin introduces an address lookup form field called <code>addressfinder</code>. The form widget renders a Google Maps autocomplete address field that automatically populates mapped fields based on the value entered and selected in the address.</p>
<p>Available mappings:</p>
<ul>
<li>street</li>
<li>city</li>
<li>zip</li>
<li>state</li>
<li>country</li>
<li>country-long</li>
<li>latitude</li>
<li>longitude</li>
<li>vicinity</li>
</ul>
<p>Available options:</p>
<p>You can restrict the address lookup to certain countries by defining the <code>countryRestriction</code> option. The option accepts a comma separated list of ISO 3166-1 ALPHA-2 compatible country codes (see: <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2</a>).</p>
<p>Usage: </p><pre class="fragment"># ===================================
#  Form Field Definitions
# ===================================

fields:
    address:
        label: Address
        type: addressfinder
        countryRestriction: 'us,ch'
        fieldMap:
            latitude: latitude
            longitude: longitude
            city: city
            zip: zip
            country: country_code
            state: state_code
            vicinity: vicinity

    city:
        label: City
    zip:
        label: Zip
    country_code:
        label: Country
    state_code:
        label: State
    latitude:
        label: Latitude
    longitude:
        label: Longitude
    vicinity:
        label: Vicinity
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
